<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Paul Miyamoto — Portfolio</title>
    <!-- Site CSS (compiled from site.css.scss) -->
    <link rel="stylesheet" href="/stylesheets/site.css">
    <!-- Google Fonts: Inter (body) + Raleway (headings) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Raleway:wght@600;700&display=swap" rel="stylesheet">
    <!-- Swiper CSS (carousel) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">
    <!-- Lightbox minimal styles (scoped here for simplicity) -->
    <style>
      .lightbox {
        position: fixed; inset: 0;
        background: rgba(0,0,0,.85);
        display: none; align-items: center; justify-content: center;
        z-index: 9999;
      }
      .lightbox.open { display: flex; }
      .lightbox img {
        max-width: 92vw; max-height: 92vh;
        border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,.6);
      }
      .lightbox .lb-close {
        position: absolute; top: 14px; right: 16px;
        background: rgba(0,0,0,.5); color: #fff;
        border: 1px solid rgba(255,255,255,.2);
        border-radius: 10px; padding: 8px 10px; cursor: pointer;
      }
    </style>
  </head>
  <body>
    <%= yield %>
    <footer class="footer">
      <div class="container">
        <span>© <span id="year"></span> Paul Miyamoto</span>
      </div>
    </footer>
    <!-- Lightbox root (click backdrop or button to close) -->
    <div id="lightbox" class="lightbox" aria-hidden="true">
      <button class="lb-close" type="button" aria-label="Close">Close ✕</button>
      <img id="lightbox-img" alt="">
    </div>
    <script>
      document.getElementById('year').textContent = new Date().getFullYear();
    </script>
    <!-- Swiper JS (carousel) -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // --- Per-project screenshot carousels ---
        document.querySelectorAll('.shots-swiper').forEach((el) => {
          const pagEl = el.parentElement.querySelector('.shots-pag');

          new Swiper(el, {
            loop: false,
            speed: 400,
            spaceBetween: 10,
            slidesPerView: 1,          // phones by default
            breakpoints: {
              640:  { slidesPerView: 2 }, // tablets
              1024: { slidesPerView: 3 }, // laptops/desktops
              1440: { slidesPerView: 3 }  // keep 3 on big screens
            },
            pagination: pagEl ? { el: pagEl, clickable: true } : undefined
          });
        });

        // --- Lightbox for screenshots ---
        const lb = document.getElementById('lightbox');
        const lbImg = document.getElementById('lightbox-img');
        const openLightbox = (src) => {
          lbImg.src = src;
          lb.classList.add('open');
          lb.setAttribute('aria-hidden', 'false');
        };
        const closeLightbox = () => {
          lb.classList.remove('open');
          lb.setAttribute('aria-hidden', 'true');
          setTimeout(() => { lbImg.src = ''; }, 150);
        };
        document.body.addEventListener('click', (e) => {
          const img = e.target.closest('.shot');
          if (!img) return;
          const full = img.getAttribute('data-full') || img.getAttribute('src');
          if (full) openLightbox(full);
        });
        lb.addEventListener('click', (e) => {
          if (e.target === lb || e.target.closest('.lb-close')) closeLightbox();
        });
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && lb.classList.contains('open')) closeLightbox();
        });
      });
    </script>
  </body>
</html>
